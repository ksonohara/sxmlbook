/*!
 * mikan.js JavaScript Web Library
 *  JavaScript Module
 *
 * Copyright (C) 2008-15 K.Sonohara
 * Code released under [Mozilla Public License, version 2.0](https://github.com/ksonohara/mikan_js/blob/master/LICENSE)
 *
 * https://github.com/ksonohara/mikan_js/
 * http://www.expertsoftware-i.com/
 *
 */
var MIKAN_JS_MIN=!0;if(void 0==MIKAN_JS_ON)var MIKAN_JS_ON=!1;if(void 0==MIKAN_JS_MIN)var MIKAN_JS_MIN=!1;if(void 0==MIKAN_DEBUG_ON)var MIKAN_DEBUG_ON=!0;if(void 0==MIKAN_TOOL_ON)var MIKAN_TOOL_ON=!1;if(void 0==MIKAN_HTDOCS_ROOT)var MIKAN_HTDOCS_ROOT="./";if(void 0==MIKAN_WSGI_ROOT)var MIKAN_WSGI_ROOT=MIKAN_HTDOCS_ROOT;if(void 0==MIKAN_CGI_ROOT)var MIKAN_CGI_ROOT=MIKAN_WSGI_ROOT;if(void 0==MIKAN_JS_ROOT)var MIKAN_JS_ROOT=MIKAN_HTDOCS_ROOT+"js/";if(void 0==MIKAN_IMAGE_ROOT)var MIKAN_IMAGE_ROOT=MIKAN_HTDOCS_ROOT+"images/";if(void 0==MIKAN_JS_MIKAN)var MIKAN_JS_MIKAN=MIKAN_JS_ROOT+"mikan/";if(void 0==MIKAN_LANG)try{var MIKAN_LANG=(navigator.userLanguage||navigator.browserLanguage||navigator.language).substr(0,2)}catch(e){var MIKAN_LANG="ja"}if(void 0==mikan){var mikan={};mikan.page={}}if(void 0==mikan.resource&&(mikan.resource={}),void 0==mikan.page&&(mikan.page={}),0==MIKAN_JS_ON){var MIKAN_JS_MIKAN_FILES=[];if(MIKAN_JS_MIN||(MIKAN_JS_MIKAN_FILES=["mikan.const.js","mikan.resource.js","mikan.util.js","mikan.html.js","mikan.css.js","mikan.dialog.js","mikan.page.js","mikan.form.js","mikan.json.js","mikan.tree.js","mikan.admin.js"]),MIKAN_JS_MIKAN_FILES.push("i18n/"+MIKAN_LANG+"/mikan.resource.js"),1==MIKAN_TOOL_ON&&MIKAN_JS_MIKAN_FILES.push("mikan.tool.js"),void 0==MIKAN_JS_FILES)var MIKAN_JS_FILES=[]}if(mikan.log=function(message){try{console.log(message)}catch(e){try{console.log(message)}catch(e){}}},mikan.log_debug=function(message){if(MIKAN_DEBUG_ON){try{console.debug(message)}catch(e){try{console.log(message)}catch(e){}}try{console.trace()}catch(e){}}},mikan.log_error=function(message){try{console.error(message)}catch(e){try{console.log(message)}catch(e){}}try{console.trace()}catch(e){}},mikan.js_load=function(base,name,charset){c=charset,null!=charset&&(c="utf-8"),document.write('<script type="text/javascript" src="'+base+name+'" charset="'+c+'">;</script>')},mikan.jss_load=function(base,names,charset){c=charset,null!=charset&&(c="utf-8");for(var i in names)mikan.js_load(base,names[i],c)},0==MIKAN_JS_ON&&void 0!=MIKAN_JS_ROOT)try{mikan.jss_load(MIKAN_JS_MIKAN,MIKAN_JS_MIKAN_FILES,"utf-8"),mikan.jss_load(MIKAN_JS_ROOT,MIKAN_JS_FILES,"utf-8"),MIKAN_JS_ON=!0}catch(e){mikan.log_error(e),MIKAN_JS_ON=!1}var MIKAN_TAG_LT="<",MIKAN_TAG_GT=">",MIKAN_TAG_QUOT='"',TAG_LT=MIKAN_TAG_LT,TAG_GT=MIKAN_TAG_GT,TAG_QUOT=MIKAN_TAG_QUOT;MIKAN_JS_ON=!0,mikan.consts={},void 0==mikan.resource&&(mikan.resource={}),mikan.resource.form={},mikan.resource.message={},mikan.resource.form.messages={},mikan.resource.OK="OK",mikan.resource.CANCEL="Cancel",mikan.resource.CLOSE="Close",mikan.resource.YES="Yes",mikan.resource.NO="No",mikan.resource.ERROR="Error",mikan.resource.CONFIRM="Confirm",mikan.resource.SUBMIT="Submit",mikan.resource.LOADING="Loading..",mikan.resource.DONE="Done",mikan.resource.PROCESS="Process",mikan.resource.PROCESSING="Processing..",mikan.resource.REQUIRED="[Required]",mikan.resource.message.DONE="Process done.",mikan.resource.form.messages.REQUIRED="Do rrequired.",mikan.resource.form.messages.NUMBER="Number only.",mikan.resource.form.messages.MATCH="is not matched.",mikan.resource.form.messages.REG="No input format.",mikan.resource.form.messages.NOSELECT="Need selected.",mikan.resource.form.messages.NOTFOUNTZIPCODE="Not Found ZipCode.",mikan.util={},mikan.util.escape=function(v,html){if(void 0==html)var html=!1;try{return html?v.replace(/</g,"&lt;").replace(/>/g,"&gt;"):$("<span />").text(val).html()}catch(e){return""}},mikan.json={},mikan.json.response=function(ajax,html){var JSON=ajax.responseText;return mikan.log_debug(JSON),JSON?(html&&(JSON=mikan.util.escape(JSON,!0)),$.parseJSON(JSON)):JSON},mikan.json.ajax=function(url,method,params,async,success,error,html,useformdata){if(void 0==async)var async=!1;if(void 0==html)var html=!0;if(void 0==useformdata)var useformdata=!1;try{var a={type:method,scriptCharset:"utf-8",url:url,dataType:"json",async:async};mikan.log_debug(a),useformdata&&(a.contentType=!1,a.processData=!1),params&&(a.data=params),success&&(a.success=success),error&&(a.error=error);var ajax=$.ajax(a);return async?ajax:mikan.json.response(ajax,html)}catch(e){error&&error(e)}return null},mikan.json.load=function(url,params,async,success,error,html,useformdata){return mikan.json.ajax(url,"GET",params,async,success,error,html,useformdata)},mikan.json.post=function(url,params,async,success,error,html,useformdata){return mikan.json.ajax(url,"POST",params,async,success,error,html,useformdata)},mikan.json.list=function(id,url,rss){try{var jsons=mikan.json.load(url,null,!1,null,null),h="";return jsons&&(h=mikan.html.bootstrap.rss(jsons.items,!1)),$(id).html(h),jsons}catch(e){mikan.log_debug(e),$(id).html(e)}return null},mikan.json.table=function(id,url,params,header,icon,footer,paneltype,vertical,rowid,rowclick){try{var jsons=mikan.json.load(url,null,!1,null,null,!1,null),h=mikan.html.bootstrap.table(jsons.keys,jsons.columns,jsons.items,header,icon,footer,paneltype,vertical,rowid,rowclick);return $("#"+id).html(h),jsons}catch(e){mikan.log_debug(e),$("#"+id).html("")}return null},mikan.html={},mikan.html.bootstrap={},mikan.html.fa={},mikan.html.fa.icon=function(icon,size){void 0==size&&(size=null);var cs="";return null!=size&&(cs=" fa-"+size),'<span class="fa fa-'+icon+cs+'"> </span>'},mikan.html.bootstrap.icon=function(icon){return'<span class="glyphicon glyphicon-'+icon+'"> </span>'},mikan.html.bootstrap.rss=function(items,url_local,icon){void 0==icon&&(icon="fa fa-rss"),mikan.log_debug(items);var h="";for(key in items)item=items[key],h+='<div class="row">',h+='<div class="col-xs-12">',h+=url_local?'<a href="'+mikan.page.url.wsgi+"/"+item.url+'">':'<a href="'+item.url+'" target="_blank">',h+="<div>",h+='<span class="',h+=icon,h+='"> </span> ',h+=item.type,h+='<span class="pull-right text-muted">'+item.date+"</span>",h+="</div>",h+='<div class="text-indent">',h+='<span class="text-muted">&nbsp;&nbsp;</span>',h+=item.title,h+="</div>",h+="</a>",h+="<br />",h+="</div>",h+="</div>";return h},mikan.html.bootstrap.table=function(keys,columns,items,header,icon,footer,paneltype,vertical,rowid,rowclick){if(void 0==header&&(header=null),void 0==icon&&(icon=null),void 0==footer&&(footer=null),void 0==paneltype&&(paneltype="default"),void 0==vertical&&(vertical=!1),void 0==rowid&&(rowid=null),void 0==rowclick&&(rowclick=null),h='<div class="panel panel-'+paneltype+'">',null!=header&&(h+='<div class="panel-heading">',h+="<h4>",null!=icon&&(h+=mikan.html.bootstrap.icon(icon)+" "),h+=header,h+="</h4>",h+="</div>"),h+='<table class="table table-striped table-bordered table-hover">',vertical){h+="<tbody>";for(var i in keys)h+="<tr>",h+='<th class="text-right">',h+=columns[keys[i]],h+="</th>",h+="<td>",h+=items[keys[i]]?items[keys[i]]:" ",h+="</td>",h+="</tr>";h+="</tbody>"}else{if(columns){h+="<thead>",h+="<tr>";for(var i in keys){var key=keys[i];h+="<th>",h+=columns[key],h+="</th>"}h+="</tr>",h+="</thead>"}h+="<tbody>";for(var item in items){var rc="",ri="";null!=rowid&&(ri=' id="'+rowid.replace("%d",item)+'"'),null!=rowclick&&(rc=' onclick="'+rowclick.replace("%d",item)+'"'),h+="<tr"+ri+rc+' class="item">';for(var i in keys){var key=keys[i];h+="<td>",h+=items[item][key]?items[item][key]:" ",h+="</td>"}h+="</tr>"}h+="</tbody>"}return h+="</table>",null!=footer&&(h+='<div class="panel-footer">',h+="<p>",h+=footer,h+="</p>"),h+="</div>",h},mikan.html.bootstrap.breadcrumbs=function(items){var h='<ol class="breadcrumb">';for(var key in items)h+="<li>",h+="<a",void 0!=items[key].href&&null!=items[key].href&&(h+=' href="',h+=items[key].href,h+='"'),void 0!=items[key].onclick&&null!=items[key].onclick&&(h+=' onclick="',h+=items[key].onclick,h+='"'),h+=">",void 0!=items[key].icon&&null!=items[key].icon&&(h+=mikan.html.bootstrap.icon(items[key].icon),h+=" "),h+=items[key].caption,h+="</a>",h+="</li>";return h+="</ol>"},mikan.html.bootstrap.message=function(title,message,dtype,icon){void 0==dtype&&(dtype="default"),void 0==icon&&(icon=null);var h="",c="panel panel-"+dtype,i=null;return icon&&(i=mikan.html.bootstrap.icon(icon)),h+='<div class="'+c+'">',h+='<div class="panel-heading">',h+="<h4>",i&&(h+=i+" "),h+=title,h+="</h4>",h+="</div>",h+='<div class="panel-body">',h+="<h4>",h+=message,h+="</h4>",h+="</div>",h+="</div>"},mikan.html.bootstrap.load_sidemenu=function(url){var _items=null;try{_items=mikan.json.load(url).items}catch(e){}return mikan.html.bootstrap.create_sidemenu(_items)},mikan.html.bootstrap.create_sidemenu=function(_items){return mikan.html.bootstrap.create_item_sidemenu(_items)},mikan.html.bootstrap.create_item_sidemenu=function(_items,_level){if(void 0==_items)return"";void 0==_level&&(_level=0);var _h="";for(var _d in _items){var _item=_items[_d];_h+="<li>",_h+="<a",_h+=void 0!==_item.url?' href="'+_item.url+'"':' href="#"',void 0!==_item.target&&(_h+=' target="'+_item.target+'"'),_h+=">",void 0!==_item.icon&&(_h+='<i class="'+_item.icon+'"> </i>'),_h+=_item.caption,void 0!==_item.items&&(_h+='<span class="fa arrow"> </span>'),_h+="</a>",void 0!==_item.items&&(_h+=1==_level?'<ul class="nav nav-third-level">':'<ul class="nav nav-second-level">',_h+=mikan.html.bootstrap.create_item_sidemenu(_item.items,_level+1),_h+="</ul>"),_h+="</li>"}return _h},mikan.css={},mikan.dialog={},mikan.dialog.result=null,mikan.dialog._confirm=function(id,title,message,onclick,yes,no,icon,titlecolor,backdrop,zindex,oncheck,size){void 0==id&&(id="mikan_dialog"),void 0==yes&&(yes="はい"),void 0==no&&(no="いいえ"),void 0==onclick&&(onclick=function(e){}),void 0==icon&&(icon="comment"),void 0==titlecolor&&(titlecolor=""),void 0==backdrop&&(backdrop=null),void 0==size&&(size="");var dialog=$("#"+id);mikan.dialog.result=null;var id_modal=id+"_modal";h='<div class="modal fade" id="'+id_modal+'" tabindex="-1" role="dialog" aria-hidden="true"',null!=backdrop&&(h+=' data-backdrop="static"'),h+='><div class="modal-dialog '+size+'">\r\n<div class="modal-content">\r\n<div class="modal-header">\r\n<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\r\n<h4 class="modal-title '+titlecolor+'"><span class="glyphicon glyphicon-'+icon+'"></span> '+title+'</h4>\r\n</div>\r\n<div class="modal-body">'+message+'</div>\r\n<div class="modal-footer">',h+=void 0==oncheck?'<button type="button" class="btn btn-primary" data-dismiss="modal" onclick="mikan.dialog.result = true;">'+yes+" </button>":'<button type="button" class="btn btn-primary" onclick=" mikan.dialog.result = '+oncheck+"(); if (mikan.dialog.result) $('#"+id_modal+"').modal('hide'); \">"+yes+" </button>",""!=no&&(h+='<button type="button" class="btn btn-default" data-dismiss="modal" onclick="mikan.dialog.result = null;">'+no+" </button>"),h+="</div>\r\n</div>\r\n</div>\r\n</div>\r\n",0!=dialog.length?dialog.html(h):$("body div").first().prepend('<div id="'+id+'">'+h+"</div>"),$("#"+id_modal).on("hidden.bs.modal",onclick),zindex&&$("#"+id_modal).css("z-index",zindex),$("#"+id_modal).parent().css("z-index",zindex);$("#"+id_modal).modal("show")},mikan.dialog.confirm=function(title,message,onclick,yes,no,icon,backdrop,zindex,oncheck,size){mikan.dialog._confirm("mikan_dialog",title,message,onclick,yes,no,icon,"",backdrop,zindex,oncheck,size)},mikan.dialog.error=function(title,message,onclick,yes,icon,backdrop,zindex,size){id="mikan_error_dialog",void 0==yes&&(yes=mikan.resource.CLOSE),void 0==onclick&&(onclick=function(e){}),void 0==zindex&&(zindex=9e3),void 0==icon&&(icon="warning-sign"),mikan.dialog._confirm(id,title,message,onclick,yes,"",icon,"text-danger",backdrop,zindex,size)},mikan.form={},mikan.form.html={},mikan.form.items={},mikan.form.event={},mikan.form.consts={},mikan.form.consts.ICON_CHECK="glyphicon-check",mikan.form.consts.ICON_UNCHECKED="glyphicon-unchecked",mikan.form.bootstrap={},mikan.form.clear_input=function(element){switch(element.type){case"hidden":case"submit":case"reset":case"button":case"image":return;case"file":return;case"text":case"password":case"textarea":return void(element.value="");case"checkbox":case"radio":return void(element.checked=!1);case"select-one":case"select-multiple":return void(element.selectedIndex=0)}},mikan.form.clear=function(f){var f=void 0===f?document.item:f,fc=function(e){if(mikan.dialog.result)for(var i=0;i<f.elements.length;++i)mikan.form.clear_input(f.elements[i])};mikan.dialog.confirm(mikan.resource.CONFIRM,"入力値を全てクリアしますか？",fc)},mikan.form.reset=function(f){var f=void 0===f?document.item:f,fc=function(e){mikan.dialog.result&&f.reset()};mikan.dialog.confirm(mikan.resource.CONFIRM,"入力値を初期状態にしますか？",fc)},mikan.form.submit=function(f){if(void 0===f)try{$("a.btn").addClass("disabled")}catch(e){}var f=void 0===f?document.item:f;f.submit()},mikan.form.tooltip=function(){try{$("button").tooltip()}catch(e){}try{$("a.btn").tooltip()}catch(e){}try{$("span.tooltip").tooltip()}catch(e){}try{$("span.glyphicon-question-sign").tooltip()}catch(e){}},mikan.form.event.select_radio=function(name,id,value){var target=$("#"+id);if(!target.hasClass("active")){var seleced=$("button."+name);seleced.removeClass("active"),seleced.removeClass("btn-primary"),seleced.addClass("btn-default"),seleced.removeAttr("checked");var seleced_icon=$("button."+name+" span."+mikan.form.consts.ICON_CHECK);seleced_icon.removeClass(mikan.form.consts.ICON_CHECK),seleced_icon.addClass(mikan.form.consts.ICON_UNCHECKED),target.addClass("active"),target.addClass("btn-primary"),target.attr("checked","true");var target_icon=$("#"+id+" span.glyphicon");target_icon.removeClass(mikan.form.consts.ICON_UNCHECKED),target_icon.addClass(mikan.form.consts.ICON_CHECK),$("#"+name).attr("value",value)}},mikan.form.event.keypress=function(s,e){return 13==e.keyCode?!1:!0},mikan.form.html.input_zipcode=function(formname,item,confirm){var h=(formname+"_"+item.name,mikan.form.html.input_text(formname,item,confirm));return confirm||(h+='<div class="col-xs-2">',h+='<button type="button" class="btn btn-primary" onclick="mikan.form.html.zipcode_to(\''+item.rpc+"','"+formname+"', '"+item.name+"', '"+item.zipcode.ken_id+"', '"+item.zipcode.city_name+"');\">住所に変換</button>",h+="</div>"),h},mikan.form.html.zipcode_to=function(rpc,formname,zipcode,ken_id,city_name){mikan.form.clear_input_error(formname,zipcode);var v_zipcode=$("#"+formname+"_"+zipcode)[0];if(v_zipcode.value){v_zipcode.value.length>4&&"-"!=v_zipcode.value[3]&&(v_zipcode.value=v_zipcode.value.substring(0,3)+"-"+v_zipcode.value.substring(3));var a=mikan.json.load(MIKAN_CGI_ROOT+rpc+"?c="+v_zipcode.value,null,!1,null,null,!1,!1);if(mikan.log_debug(a),a){var v_ken_id=$("#"+formname+"_"+ken_id)[0],v_city_name=$("#"+formname+"_"+city_name)[0];if(a.ken_id&&a.city_name)return v_ken_id.value=a.ken_id,void(v_city_name.value=a.city_name)}mikan.form.set_input_error(formname,zipcode,mikan.resource.form.messages.NOTFOUNTZIPCODE)}},mikan.form.html.input_text=function(formname,item,confirm){var name=formname+"_"+item.name,h='<div class="col-xs-'+item.width+'">';if(confirm)"password"!=item.type?(h+=mikan.form.html.input_hidden(formname,item),h+="<p>",h+=mikan.util.escape(item.value,!0),h+="</p>"):h+="<p> </p>";else{var clazz="form-control";h+='<input type="'+item.type+'" class="'+clazz+'" name="'+item.name+'" id="'+name+'""',item.maxlength&&(h+=' maxlength="'+item.maxlength+'"'),item.hint&&(h+=' placeholder="'+item.hint+'"'),0==item.edit&&(h+=' disabled="disabled"'),h+=' value="'+item.value+'"',item.required&&(h+=' required="true"'),h+=' onkeypress=" return mikan.form.event.keypress(this, event); " />'}return h+="</div>"},mikan.form.html.input_label=function(formname,item,confirm){return""},mikan.form.html.input_iframe=function(formname,item,confirm){return'<iframe class="form_iframe" frameborder="1" src="'+item.value+'" width="75%" height="250px" max-height="300px"> </iframe>'},mikan.form.html.input_select=function(formname,item,confirm){return mikan.form.html.input_multi(formname,item,!1)},mikan.form.html.input_multi=function(formname,item,multi,confirm){if(void 0===multi)var multi=!0;var name=formname+"_"+item.name,h="";h+='<div class="controls col-xs-'+item.width+'">';var clazz=name+" form-control input-xlarge",disabled="";0==item.edit&&(clazz+=" disabled",disabled=' disabled="disabled"'),multi&&(clazz+=" multiple"),h+='<select id="'+name+'" name="'+item.name+'" class="'+clazz+'"',void 0!=item.onchange&&(h+=' onchange="'+item.onchange+'"'),h+=disabled,multi&&(h+=' multiple="multiple"'),h+=">";var v=item.value;if(v)try{v=v.split(",")}catch(e){v=[v]}else v=[v];for(var i in item.select)h+='<option value="'+i+'"',-1!=jQuery.inArray(i,v)&&(h+=' selected="True"'),h+=">",h+=item.select[i],h+="</option>";return h+="</select>",h+="</div>"},mikan.form.html.input_radio=function(formname,item,confirm){var name=formname+"_"+item.name,h="";h+='<div class="controls col-xs-'+item.width+'">',h+='<div class="btn-group" data-toggle="buttons">',h+='<input type="hidden" id="'+name+'" name="'+item.name+'" value="'+item.value+'" />';for(var i in item.select){var clazz=name+" btn",disabled="",checked="",icon=mikan.html.bootstrap.icon("unchecked");item.value==i?(clazz+=" btn-primary active",icon=mikan.html.bootstrap.icon("check"),checked='checked="true"'):clazz+=" btn-default",0==item.edit&&(clazz+=" disabled",disabled=' disabled="disabled"'),h+='<button name="'+item.name+'" id="'+name+i+'" class="'+clazz+'" onclick="mikan.form.event.select_radio(\''+name+"','"+name+i+"','"+i+"'); \"",h+=disabled,h+=' onkeypress=" return mikan.form.event.keypress(this, event); ">',h+=icon,h+=" ",h+=item.select[i],h+="</button> "}return h+="</div>",h+="</div>"},mikan.form.html.input_message=function(formname,item,confirm){var h=(formname+"_"+item.name,'<div class="col-xs-'+item.width+'">');return h+="<p>",h+=mikan.util.escape(item.value,!0),h+="</p>"},mikan.form.html.input_checkbox=function(formname,item,confirm){var name=formname+"_"+item.name,h="";h+='<div class="controls col-xs-'+item.width+'">';var clazz="control-label",checked="";if(1==item.value&&(checked='checked="true"'),!confirm){var disabled="";0==item.edit&&(clazz+=" disabled",disabled=' disabled="disabled"'),h+='<input class="" type="checkbox" name="'+item.name+'" id="'+name+'" placeholder="" value=" '+item.value+'" '+checked+disabled+" ",void 0!=item.onchange&&(h+=' onchange="'+item.onchange+'"'),0==item.edit&&(disabled=' disabled="disabled"'),h+=disabled,h+=" /> "}return h+='<label for="'+name+'" class="'+clazz+'">',void 0!=item.check&&(h+=item.check),h+="</label> ",h+="</div>"},mikan.form.html.input_textarea=function(formname,item,confirm){var name=formname+"_"+item.name,h="";if(h+='<div class="controls col-xs-'+item.width+'">',confirm)h+=mikan.form.html.input_hidden(formname,item),h+="<p>",h+=mikan.util.escape(item.value,!0).replace(/\n/g,"<br />"),h+="</p>";else{var disabled="",clazz="";0==item.edit&&(clazz+=" disabled",disabled=' readonly="readonly"'),h+="<textarea",h+=' class="'+clazz+'"',h+=' cols="'+10*item.width+'"',h+=' rows="8"',item.hint&&(h+=' placeholder="'+item.hint+'"'),h+=' id="'+name+'"',h+=' name="'+item.name+'"',h+=disabled,h+=">",h+=item.value,h+="</textarea>"}return h+="</div>"},mikan.form.html.input_hidden=function(formname,item){var name=formname+"_"+item.name,h="";return h+='<input type="hidden" name="'+item.name+'" id="'+name+'""',h+=' value="'+item.value+'"',h+=" />"},mikan.form.html.input_file=function(formname,item,confirm){var name=formname+"_"+item.name,h="";return confirm||(h+='<input type="file" name="'+item.name+'" id="'+name+'""',h+=" />"),h},mikan.form.value6select=function(name,selects){for(var key in selects)if(selects[key]==name)return key;return null},mikan.form.html.load_json=function(id,url,formname,custom){mikan.form.items[formname]=mikan.json.load(url,!1);var h=mikan.form.html.create_inputs(formname,mikan.form.items[formname],custom,!1);return id&&($("#"+id).html(h),$("#"+id+"_message").html("")),$("#"+formname+"_submit").removeClass("disabled"),h},mikan.form.html.back_json=function(id,formname,custom,message){if(void 0==message)var message="";var h=mikan.form.html.create_inputs(formname,mikan.form.items[formname],custom,!1);return id&&($("#"+id).html(h),$("#"+id+"_message").html(message)),$("#"+formname+"_submit").removeClass("hidden"),$("#"+formname+"_back").addClass("hidden"),$("html,body").animate({scrollTop:0},"fast"),h},mikan.form.confirm_json=function(id,formname,post_url,custom,confirm){if(void 0==confirm)var confirm=!0;if(void 0==post_url)var post_url="";if($("html,body").animate({scrollTop:0},"fast"),$("#"+formname+"_back").hasClass("hidden"))if(null==mikan.form.validate_json(formname,custom)){if(confirm){$("#"+formname+"_back").removeClass("hidden"),mikan.form.items[formname]=mikan.form.value6form(formname,mikan.form.items[formname],custom);var h=mikan.form.html.create_inputs(formname,mikan.form.items[formname],custom,!0);return id&&($("#"+id).html(h),$("#"+id+"_message").html(mikan.html.bootstrap.message(mikan.resource.CONFIRM,"以下の内容でよろしいでしょうか？以下の内容で続ける場合実行を選択してください。","success","user"))),h}mikan.form.items[formname]=mikan.form.value6form(formname,mikan.form.items[formname],custom)}else if(id)return void $("#"+id+"_message").html(mikan.html.bootstrap.message(mikan.resource.ERROR,"入力内容を御確認ください。","danger","user"));$("#"+id+"_message").html(mikan.html.bootstrap.message(mikan.resource.PROCESS,'<img src="'+MIKAN_IMAGE_ROOT+'loading.gif" alt="'+mikan.resource.LOADING+'" />'+mikan.resource.PROCESSING,"info","repeat")),$("#"+formname+"_submit").addClass("hidden"),$("#"+formname+"_back").addClass("hidden");var fd=new FormData;for(var key in mikan.form.items[formname]){var item=mikan.form.items[formname][key];if(MIKAN_DEBUG_ON===!0&&(console.log(item.name),console.log(item.value)),"file"!=item.type)fd.append(item.name,item.value);else{var a=$("#"+formname+"_"+item.name);MIKAN_DEBUG_ON===!0&&(mikan.log_debug(a),mikan.log_debug(a[0])),fd.append(item.name,a[0].files[0])}}return done=function(d){MIKAN_DEBUG_ON===!0&&mikan.log_debug(d);var m=null,t="",s=mikan.resource.message.DONE;if(d)if(d instanceof Error)try{m=m.message}catch(e){}else{if(void 0!==d.responseText)try{{d.responseText}try{m=mikan.util.escape(d.responseText,!0)}catch(e){mikan.log_error(e),mikan.log_debug(d.responseText),m=mikan.resource.ERRORl}}catch(e){}if(null==m)try{0==d.status?d.message&&(s=d.message):m=d.message}catch(e){mikan.log_error(e),m=e.message}}else m=mikan.resource.ERROR;if(m)t=mikan.html.bootstrap.message(mikan.resource.ERROR,m,"danger","warning-sign"),mikan.form.html.back_json(id,formname,custom,t);else{var h=mikan.form.html.create_inputs(formname,mikan.form.items[formname],custom,!0);$("#"+id).html(h),s=mikan.html.bootstrap.message(mikan.resource.DONE,s,"info","saved"),$("#"+id+"_message").html(s),mikan.form.items[formname]=null}},MIKAN_DEBUG_ON===!0&&console.log(post_url),mikan.json.post(post_url,fd,!0,done,done,!1,!0),null},mikan.form.validate_json=function(formname,custom){return mikan.form.validate(formname,mikan.form.items[formname],custom)},mikan.form.html.confirm_inputs=function(formname,items,custom){return mikan.form.html.create_inputs(formname,items,custom,!0)},mikan.form.html.create_inputs=function(formname,items,custom,confirm,required_mark){if(void 0==confirm)var confirm=!1;if(void 0==required_mark)var required_mark=mikan.resource.REQUIRED;var is=items;try{void 0!=items.items&&(is=items.items)}catch(e){}try{is.sort(function(a,b){try{var a_sort=a.sort,b_sort=b.sort;return void 0==a_sort?0:void 0==b_sort?0:b_sort>a_sort?-1:a_sort>b_sort?1:0}catch(e){return 0}})}catch(e){}var h="";h+='<div class="row">';var fg=!1;for(var key in is){var item=is[key],name=formname+"_"+item.name;if(!confirm||"iframe"!=item.type){if("hidden"!=item.type){0!=item.formgroup&&(fg&&(h+="</div>"),h+='<div class="form-group">',fg=!0);var label=3;void 0!=item.label&&(label=item.label);var clazz=name+" control-label col-xs-"+label;void 0!=item.offset&&(clazz+=" col-xs-offset-"+item.offset),1==item.nolabel&&(clazz+=" sr-only"),h+='<label for="'+name+'" class="text-right '+clazz+'">',h+=item.caption,item.required&&!confirm&&0!=item.edit&&(h+=" "+required_mark),h+="</label>"}"text"==item.type||"number"==item.type||"password"==item.type||"datetime"==item.type||"datetime-local"==item.type||"date"==item.type||"month"==item.type||"time"==item.type||"week"==item.type||"email"==item.type||"url"==item.type||"search"==item.type||"tel"==item.type||"color"==item.type?h+=mikan.form.html.input_text(formname,item,confirm):"zipcode"==item.type?h+=mikan.form.html.input_zipcode(formname,item,confirm):"label"==item.type?h+=mikan.form.html.input_label(formname,item,confirm):"select"==item.type?h+=mikan.form.html.input_select(formname,item,confirm):"multi"==item.type?h+=mikan.form.html.input_multi(formname,item,!0,confirm):"hidden"==item.type?h+=mikan.form.html.input_hidden(formname,item,confirm):"radio"==item.type?h+=mikan.form.html.input_radio(formname,item,confirm):"checkbox"==item.type?h+=mikan.form.html.input_checkbox(formname,item,confirm):"message"==item.type?h+=mikan.form.html.input_message(formname,item,confirm):"textarea"==item.type?h+=mikan.form.html.input_textarea(formname,item,confirm):"iframe"==item.type?h+=mikan.form.html.input_iframe(formname,item,confirm):"file"==item.type?h+=mikan.form.html.input_file(formname,item,confirm):void 0!=custom&&(h+=custom(formname,item,confirm))}}return fg&&(h+="</div>"),h+="</div>"},mikan.form.value=function(formname,item,custom){var a=$("#"+formname+"_"+item.name);return"text"==item.type||"number"==item.type||"password"==item.type||"datetime"==item.type||"datetime-local"==item.type||"date"==item.type||"month"==item.type||"time"==item.type||"week"==item.type||"email"==item.type||"url"==item.type||"search"==item.type||"tel"==item.type||"color"==item.type||"zipcode"==item.type?a[0].value:"select"==item.type||"multi"==item.type?a[0].value:"number"==item.type?a[0].value:"radio"==item.type?a[0].value:"checkbox"==item.type?1==a[0].checked:"textarea"==item.type?a[0].value:"hidden"==item.type?a[0].value:"file"==item.type?a[0].value:"iframe"==item.type?"":"message"==item.type?null:void 0!=custom?custom(formname,item):null},mikan.form.set_input_error=function(formname,item,message){var ui=mikan.form.get_input_label(formname,item);for(var i in ui)null!=ui[i]&&ui[i].addClass("has-error");if(message)try{ui.input.parent().append('<span class="help-block">'+mikan.html.bootstrap.icon("hand-up")+" "+message+"</span>")}catch(e){}},mikan.form.get_input_label=function(formname,item){var name=item;item&&item.name&&(name=item.name);var label=$("label."+formname+"_"+name),input=$("#"+formname+"_"+name),group=input.parent(""),other=null;return{label:label,input:input,group:group,other:other}},mikan.form.clear_input_error=function(formname,item){var ui=mikan.form.get_input_label(formname,item);for(var i in ui)ui[i]&&ui[i].removeClass("has-error");try{ui.input.parent().children("span.help-block").remove()}catch(e){}},mikan.form.value6form=function(formname,items,custom){var is=items;try{void 0!=items.items&&(is=items.items)}catch(e){}for(var i in is){var item=is[i];if("iframe"!==item.type){var value=mikan.form.value(formname,item,custom);is[i].value=value}}return is},mikan.form.validate=function(formname,items,custom,mesasges){if(void 0==mesasges)var mesasges=mikan.resource.form.messages;var results={},is=items;try{void 0!=items.items&&(is=items.items)}catch(e){}for(var i in is){var item=is[i];mikan.form.clear_input_error(formname,item);var value=mikan.form.value(formname,item,custom);mikan.form.validate_input(formname,item,mesasges,results,value,is,custom)}for(var i in results)return results;return null},mikan.form.get_item=function(items,name){for(var i in items){var item=items[i];if(item.name==name)return item}return null},mikan.form.validate_input=function(formname,item,mesasges,results,value,items,custom){if(void 0==mesasges)var mesasges=mikan.resource.form.messages;input=$("#"+formname+"_"+item.name);var v=jQuery.trim(value);if(input.attr("disabled"));else{var von=v?!0:!1;if(0===value&&(von=!0),value===!1&&(von=!1),void 0===value&&(von=!1),von){if(item.reg){var r=item.reg;if(value.match(r));else{var m=void 0===mesasges.REG?mesasges.reg:mesasges.REG;results[item.name]={},results[item.name].type="error",results[item.name].category="reg",results[item.name].mesasge=m,mikan.form.set_input_error(formname,item,m)}}if(item.number){var r="^-*[0-9]*$";"float"==item.number.type&&(r+=".[0-9]*");{var re=new RegExp(r);re.exec(value)}if(value.match(r)&&value>=item.number.min&&value<=item.number.max);else{var m=void 0===mesasges.NUMBER?mesasges.number:mesasges.NUMBER;results[item.name]={},results[item.name].type="error",results[item.name].category="number",results[item.name].mesasge=m,mikan.form.set_input_error(formname,item,m)}}if(item.match){var ii=mikan.form.get_item(items,item.match),vv=mikan.form.value(formname,ii,custom);if(mikan.log_debug(ii),mikan.log_debug(value),mikan.log_debug(vv),vv!=value){var m=void 0===mesasges.MATCH?mesasges.match:mesasges.MATCH;m=m,results[item.name]={},results[item.name].type="error",results[item.name].category="number",results[item.name].mesasge=m,mikan.form.set_input_error(formname,ii,item.caption+" "+m),mikan.form.set_input_error(formname,item,ii.caption+" "+m)}}}else if(item.required){var m=void 0===mesasges.REQUIRED?mesasges.required:mesasges.REQUIRED;results[item.name]={},results[item.name].type="error",results[item.name].category="required",results[item.name].mesasge=m,mikan.form.set_input_error(formname,item,m)}}},mikan.report={},mikan.report.bill={},mikan.report.bill.desc=function(id,_items,target){var h="";for(i in target){var d=target[i];h+="<tr>",h+='<th class="text-right" style="white-space: nowrap;">',h+=void 0!=d.title?d.title+":":" ",h+="</th>",h+="<td>",h+=void 0!=d.text?d.text:" ",h+="</td>",h+="</tr>"}$("#"+id).html(h)},mikan.report.bill.total=function(_items){var h="";for(i in items.total){var d=_items.total[i];if(h+="<tr>",d.bold)var t="th";else var t="td";h+="<"+t+' class="text-right">',h+=void 0!=d.title?d.title+":":" ",h+="</"+t+">",h+="<"+t+' class="text-right">',h+="<span> ",h+=void 0!=d.text?d.text:" ",h+=" </span>",h+="<span>"+_items.base.yen+"</span>",h+="</"+t+">",h+="</tr>"}$("#bill_total").html(h)},mikan.report.bill.to_from=function(id,_items,target,tag){var h="<"+tag+' style="white-space: nowrap;">'+target.title+"</"+tag+">";h+='<div class="container">';for(i in target.text)h+="<p>",h+=target.text[i],h+="</p>";h+="</div>",$("#"+id).html(h)},mikan.report.bill.title=function(_items){$("#bill_title").html(_items.base.title)},mikan.report.bill.price=function(_items){var h="";for(i in items.total){var d=_items.total[i];h=d.text}$("#bill_pirce").html(h+" "+items.base.yen)},mikan.report.bill.items=function(_items){var h="";for(i in items.total){var d=_items.items[i];if(h+="<tr>",d.bold)var t="th";else var t="td";h+="<"+t+' class="text-center">',h+=void 0!=d.title?d.title:" ",h+="</"+t+">",h+="<"+t+' class="text-left">',h+=void 0!=d.text?d.text:" ",h+="</"+t+">",h+="<"+t+' class="text-right">',h+="<span> ",h+=void 0!=d.price?d.price:" ",h+=" </span>",h+="</"+t+">",h+="<"+t+' class="text-right">',h+="<span> ",h+=void 0!=d.quantity?d.quantity:" ",h+=" </span>",h+="</"+t+">",h+="<"+t+' class="text-right">',h+="<span> ",h+=void 0!=d.total?d.total:" ",h+=" </span>",h+="</"+t+">",h+="</tr>"}$("#bill_items").html(h)},mikan.report.bill.show=function(url){var _items=mikan.json.load(url);return mikan.report.bill.title(_items),mikan.report.bill.to_from("bill_to",_items,_items.to,"h3"),mikan.report.bill.to_from("bill_from",_items,_items.from,"h4"),mikan.report.bill.desc("bill_summary",_items,_items.summary),mikan.report.bill.price(_items),mikan.report.bill.items(_items),mikan.report.bill.total(_items),mikan.report.bill.desc("bill_desc",_items,_items.desc),_items},mikan.page={},mikan.page.onload=null,mikan.page.onloads={},mikan.page.url={},mikan.page.url.wsgi=MIKAN_CGI_ROOT,mikan.page.url.js=MIKAN_JS_ROOT,mikan.page.url.image=MIKAN_IMAGE_ROOT,mikan.page.url.htdocs=MIKAN_HTDOCS_ROOT,mikan.page.book={},mikan.page.book.current=null,mikan.page.load=function(){try{
mikan.form.tooltip()}catch(e){}try{$(".colorbox").colorbox({width:"80%",height:"80%",rel:"colorbox"})}catch(e){}mikan.page.onload&&mikan.page.onload();for(var l in mikan.page.onloads)try{mikan.page.onloads[l]()}catch(e){console.log(e)}mikan.page.load_sidemenu(),$(window).bind("load resize",mikan.page.load_resize);try{$("#page_loading").fadeOut("fast")}catch(e){}try{$("#page_main").fadeIn("slow")}catch(e){}$("div.navbar-collapse").addClass("collapse")},mikan.page.unload=function(){},mikan.page.back=function(){history.back()},mikan.page.showbook=function(id){if(null!=mikan.page.book.current)try{$(mikan.page.book.current).addClass("hidden").hide()}catch(e){}else try{$("#summary_jumbotron").addClass("hidden").hide()}catch(e){}null==id?$("#summary_jumbotron").removeClass("hidden").show():$(id).removeClass("hidden").show(),mikan.page.book.current=id},mikan.page.load_sidemenu=function(){try{$("#side-menu").metisMenu({toggle:!0})}catch(e){mikan.log(e)}mikan.page.load_resize()},mikan.page.load_resize=function(){try{mikan.log(window.innerWidth),topOffset=50,width=window.innerWidth>0?window.innerWidth:screen.width,width<768?($("div.navbar-collapse").addClass("collapse"),topOffset=100):$("div.navbar-collapse").removeClass("collapse"),height=(window.innerHeight>0?window.innerHeight:screen.height)-1,height-=topOffset,height<1&&(height=1),height>topOffset&&$("#page-wrapper").css("min-height",height+"px")}catch(e){mikan.log(e)}},mikan.log("aaa"),$(window).load(function(){mikan.log("bbb"),mikan.page.load(),mikan.log("ccc")}),mikan.log("ddd");
//# sourceMappingURL=mikan.min.js.map